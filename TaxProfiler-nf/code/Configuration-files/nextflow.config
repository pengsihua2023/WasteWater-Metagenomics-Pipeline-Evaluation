// nextflow.config - nf-core/taxprofiler configuration file
params {
    // Input and output
    input               = 'samplesheet.csv'
    outdir              = 'results_viral'

    // Database configuration (using database table)
    databases           = 'databases.csv'

    // Tool execution settings
    run_kraken2         = true
    run_bracken         = true
    
    // Bracken parameters - for abundance calculation
    bracken_precision   = 'S'  // Species level
    bracken_readlen     = 150  // Read length (adjust based on your data)
    save_analysis_ready_fastqs = true  // Save preprocessed reads
    
    // Profiling and standardized output
    run_profile_standardisation = true
    standardisation_motus_generatebiom = true  // Generate BIOM format
    
    // Save intermediate outputs for abundance calculation
    save_preprocessed_reads = true
    
    // Skip unnecessary steps
    perform_shortread_qc         = true
    perform_longread_qc          = false
    perform_shortread_complexityfilter = false
    perform_shortread_hostremoval      = false
    perform_longread_hostremoval       = false
    perform_runmerging                 = true
    
    // Resource limits
    max_cpus            = 32
    max_memory          = '256.GB'
    max_time            = '72.h'
}

profiles {
    apptainer {
        apptainer.enabled    = true
        apptainer.autoMounts = true
        apptainer.cacheDir   = "$HOME/.apptainer_cache"
        // Exclude non-existent /lscratch mount point to prevent container creation failure
        apptainer.runOptions = '--no-mount /lscratch'
    }
}
